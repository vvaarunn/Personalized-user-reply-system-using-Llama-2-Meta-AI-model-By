# -*- coding: utf-8 -*-
"""black_bear_diner_llama2.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1HwWJenu1t8qSqyFEpMR2eCkV1_iC3hvi
"""

import pandas as pd

df = pd.read_csv("Black_Bear_Diner_raw.csv")
df

#Dropping unesesary columns
drop_col = ["NBa7we src","d4r55","RfnDt",	"rsqaWe","nM6d2c","DZSIDd"]
df.drop(columns= drop_col, inplace=True)

#Dropping rows wiht nan values
df.dropna(inplace=True)

#Renaming column names
df.rename(columns={'wiI7pd': 'owner_reply', 'wiI7pd 2': 'user_reply'}, inplace=True)
df

# Swaping the columns
df = df[['user_reply', 'owner_reply']]
df

#rows_to_drop = [2, 8, 11, 12, 17, 18, 21, 34, 42, 46, 51, 59, 63, 67, 72, 74, 81, 82, 85, 89, 90, 95, 98, 99, 102]
#cleaned_df = df.drop(rows_to_drop)

#cleaned_df

# Open a new file to write the formatted data
with open("formatted_data.txt", "w") as file:
    # Iterate over each row in the DataFrame
    for index, row in df.iterrows():
        # Remove extra spaces from user_reply and owner_reply
        user_reply = ' '.join(row['user_reply'].split())
        owner_reply = ' '.join(row['owner_reply'].split())

        # Format the row with <s> and </s> tags
        formatted_row = f"<s> [INST] {user_reply} [/INST] {owner_reply} </s>\n"

        # Write the formatted row to the file
        file.write(formatted_row)

# Opening the file and reading its contents
with open("formatted_data.txt", "r") as file:
    content = file.read()

# Print the contents of the file
print(content)

# import pandas as pd

# # Assuming df is your DataFrame containing the "user_reply" column
# # Replace df with your actual DataFrame name if it's different
# df_reply = df["user_reply"]

# # Save the DataFrame as a single-column CSV file with header name "user_reply"
# df_reply.to_csv("cmts.csv", index=False, header=["user_reply"])

# # Download the CSV file
# from google.colab import files
# files.download("cmts.csv")